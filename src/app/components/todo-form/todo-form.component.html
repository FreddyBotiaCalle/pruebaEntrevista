<ion-card>
  <ion-card-header>
    <ion-card-title>Crear Nueva Tarea</ion-card-title>
  </ion-card-header>
  <ion-card-content>
    <form [formGroup]="todoForm" (ngSubmit)="onSubmit()">
      <ion-item>
        <ion-label position="floating">Título *</ion-label>
        <ion-input
          type="text"
          formControlName="title"
          placeholder="Ingrese el título de la tarea"
        ></ion-input>
      </ion-item>

      <div *ngIf="submitted && title?.invalid" style="color: var(--ion-color-danger); font-size: 0.8rem; padding: 0.5rem;">
        <div *ngIf="title?.errors?.['required']">El título es requerido</div>
        <div *ngIf="title?.errors?.['minlength']">El título debe tener al menos 3 caracteres</div>
      </div>

      <ion-item>
        <ion-label position="floating">Descripción</ion-label>
        <ion-input
          type="text"
          formControlName="description"
          placeholder="Ingrese una descripción (opcional)"
        ></ion-input>
      </ion-item>

      <ion-item>
        <ion-label position="floating">Fecha de Vencimiento</ion-label>
        <ion-input
          type="date"
          formControlName="dueDate"
        ></ion-input>
      </ion-item>

      <ion-item>
        <ion-label position="floating">Categoría</ion-label>
        <ion-select formControlName="categoryId" placeholder="Selecciona una categoría (opcional)">
          <ion-select-option value="">Sin categoría</ion-select-option>
          <ion-select-option *ngFor="let category of categories$ | async" [value]="category.id">
            {{ category.name }}
          </ion-select-option>
        </ion-select>
      </ion-item>

      <div style="display: flex; gap: 0.5rem; margin-top: 1rem;">
        <ion-button type="submit" expand="block" color="primary">
          Crear Tarea
        </ion-button>
        <ion-button type="button" expand="block" color="light" (click)="resetForm()">
          Limpiar
        </ion-button>
      </div>
    </form>
  </ion-card-content>
</ion-card>
